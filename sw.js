const eventsData = [
    { 
        id: 'ramadan', date: "2026-02-18T00:00:00+03:00", preTime: "2026-02-17T18:30:00+03:00", 
        title: "Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ ðŸŒ’", 
        preMsg: "ØªÙ‡Ù†Ø¦ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ù‚Ø¯ÙˆÙ… Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØŒ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø§Ù„ØµÙŠØ§Ù… ÙˆØ§Ù„Ù‚ÙŠØ§Ù… ÙˆØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ðŸŒ’",
        startMsg: "Ø¨Ø¯Ø£ Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù†ØŒ Ù‚Ø§Ù„ Ø§Ù„Ù†Ø¨ÙŠ ï·º: 'ØªÙŽØ³ÙŽØ­ÙŽÙ‘Ø±ÙÙˆØ§ ÙÙŽØ¥ÙÙ†ÙŽÙ‘ ÙÙÙŠ Ø§Ù„Ø³ÙŽÙ‘Ø­ÙÙˆØ±Ù Ø¨ÙŽØ±ÙŽÙƒÙŽØ©Ù‹' ðŸŒ™"
    },
    { 
        id: 'eid1', date: "2026-03-20T00:00:00+03:00", preTime: "2026-03-19T18:55:00+03:00", 
        title: "Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ ðŸŽˆ", 
        preMsg: "ØªÙ‡Ù†Ø¦ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ù‚Ø¯ÙˆÙ… Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØŒ ÙˆØ£Ø¹Ø§Ø¯Ù‡ Ø§Ù„Ù„Ù‡ Ø¨Ø§Ù„ÙŠÙ…Ù† ÙˆØ§Ù„Ø¨Ø±ÙƒØ§Øª ðŸŽˆ",
        startMsg: "Ø¨Ø¯Ø£ Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±ØŒ 'ÙƒØ§Ù† Ø±Ø³ÙˆÙ„ Ø§Ù„Ù„Ù‡ ï·º Ù„Ø§ ÙŠØºØ¯Ùˆ ÙŠÙˆÙ… Ø§Ù„ÙØ·Ø± Ø­ØªÙ‰ ÙŠØ£ÙƒÙ„ ØªÙ…Ø±Ø§ØªØŒ ÙˆÙŠØ£ÙƒÙ„Ù‡Ù† ÙˆØªØ±Ù‹Ø§' âœ¨"
    },
    { 
        id: 'hajj', date: "2026-05-18T00:00:00+03:00", preTime: "2026-05-17T19:00:00+03:00", 
        title: "Ø¹Ø´Ø± Ø°ÙŠ Ø§Ù„Ø­Ø¬Ø© ðŸ•‹", 
        preMsg: "Ø¨Ø¯Ø£Øª Ø§Ù„Ø¹Ø´Ø± ÙÙ‡ÙŠ Ø£ÙØ¶Ù„ Ø£ÙŠØ§Ù… Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆØ¶Ø§Ø¹ÙÙˆØ§ ÙÙŠÙ‡Ø§ Ø¨Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµØ§Ù„Ø­Ø© ðŸŒŸ",
        startMsg: "Ø¨Ø¯Ø£ Ø´Ù‡Ø± Ø°ÙŠ Ø§Ù„Ø­Ø¬Ø©ØŒ Ù‚Ø§Ù„ ï·º: 'Ù…Ø§ Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­ ÙÙŠÙ‡Ø§ Ø£Ø­Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£ÙŠØ§Ù…' ðŸ•‹"
    },
    { 
        id: 'eid2', date: "2026-05-27T00:00:00+03:00", preTime: "2026-05-26T19:00:00+03:00", 
        title: "Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ ðŸ‘", 
        preMsg: "ÙŠÙ‡Ù†Ø¦ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ù‚Ø¯ÙˆÙ… Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØŒ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ø§ ÙˆÙ…Ù†ÙƒÙ… ØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ðŸŽˆ",
        startMsg: "Ø¨Ø¯Ø£ Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ØŒ Ù‚Ø§Ù„ ï·º: 'Ù…ÙŽØ§ Ø¹ÙŽÙ…ÙÙ„ÙŽ Ø§Ø¨Ù’Ù†Ù Ø¢Ø¯ÙŽÙ…ÙŽ ÙŠÙŽÙˆÙ’Ù…ÙŽ Ø§Ù„Ù†ÙŽÙ‘Ø­Ù’Ø±Ù Ø¹ÙŽÙ…ÙŽÙ„Ø§Ù‹ Ø£ÙŽØ­ÙŽØ¨ÙŽÙ‘ Ø¥ÙÙ„ÙŽÙ‰ Ø§Ù„Ù„Ù‡Ù ÙƒÙŽÙ…ÙÙ†Ù’ Ø¥ÙÙ‡Ù’Ø±ÙŽØ§Ù‚Ù Ø§Ù„Ø¯ÙŽÙ‘Ù…Ù' ðŸ‘"
    }
];

self.addEventListener('install', (e) => self.skipWaiting());

setInterval(() => {
    const now = new Date();
    eventsData.forEach(ev => {
        const pTime = new Date(ev.preTime);
        const sTime = new Date(ev.date);
        if (Math.abs(now - pTime) < 30000) triggerPush(ev.title, ev.preMsg, ev.id + "_pre");
        if (Math.abs(now - sTime) < 30000) triggerPush(ev.title, ev.startMsg, ev.id + "_start");
    });
}, 60000);

function triggerPush(title, body, tag) {
    self.registration.showNotification(title, {
        body: body,
        icon: 'https://i.ibb.co/fzPfcMp0/small-logo.png',
        badge: 'https://i.ibb.co/fzPfcMp0/small-logo.png',
        tag: tag,
        vibrate: [200, 100, 200],
        data: { url: 'https://sdkd2039.github.io/residual/' }
    });
}

self.addEventListener('notificationclick', (event) => {
    event.notification.close();
    event.waitUntil(clients.openWindow(event.notification.data.url));
});
