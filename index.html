<!DOCTYPE html>
<html lang="ar" dir="rtl" id="main-html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المتبقي | Al-Mutabaqi</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffd700">
    
    <link rel="apple-touch-icon" href="https://i.ibb.co/fYWfbWBQ/logo.png">
    <link rel="icon" type="image/png" href="https://i.ibb.co/fYWfbWBQ/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg-body: #080c14; --bg-card: #1e293b; --text-main: #ffffff; --text-muted: #94a3b8; --accent: #ffd700; --box-bg: #0f172a; --blue-notif: #3b82f6; }
        [data-theme="light"] { --bg-body: #f8fafc; --bg-card: #ffffff; --text-main: #0f172a; --text-muted: #64748b; --accent: #10b981; --box-bg: #f1f5f9; --blue-notif: #2563eb; }
        body { background-color: var(--bg-body); color: var(--text-main); font-family: 'IBM Plex Sans Arabic', 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; padding: 20px; transition: 0.3s; }
        .controls { position: fixed; top: 20px; left: 20px; display: flex; gap: 10px; z-index: 1000; }
        .btn-tool { background: var(--accent); color: #000; border: none; padding: 10px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
        .main-logo { width: 150px; margin: 20px 0; }
        .card { background: var(--bg-card); border-radius: 20px; padding: 25px; margin-bottom: 20px; width: 100%; max-width: 450px; text-align: center; position: relative; }
        .share-mini { position: absolute; top: 15px; left: 15px; background: rgba(255,255,255,0.05); border: 1px solid var(--accent); color: var(--accent); padding: 5px 8px; border-radius: 8px; cursor: pointer; font-size: 0.7rem; }
        html[dir="ltr"] .share-mini { left: auto; right: 15px; }
        .event-title { color: var(--accent); font-size: 1.4rem; font-weight: bold; }
        .timer-grid { display: flex; justify-content: space-between; gap: 8px; margin-top: 15px; }
        .box { background: var(--box-bg); padding: 10px 5px; border-radius: 12px; flex: 1; }
        .num { display: block; font-size: 1.4rem; color: var(--accent); font-weight: bold; }
        .label { font-size: 0.65rem; color: var(--text-muted); }
        .notify-row { margin-top: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 0.85rem; color: var(--text-muted); border-top: 1px solid rgba(255,255,255,0.05); padding-top: 15px; }
        
        .switch { position: relative; display: inline-block; width: 34px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #475569; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        
        input:checked + .slider { background-color: var(--blue-notif); }
        input:checked + .slider:before { transform: translateX(14px); }

        .verse-box { background: var(--bg-card); padding: 20px; border-radius: 15px; max-width: 500px; text-align: center; line-height: 1.8; margin: 20px 0; border: 1px solid rgba(255, 215, 0, 0.2); }
        .quran-text { display: block; font-size: 1.15rem; color: var(--accent); direction: rtl !important; }
        .translation-text { display: block; font-size: 0.85rem; color: var(--text-muted); font-style: italic; margin-top: 10px; }
        .verse-ref { display: block; margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="controls">
        <button class="btn-tool" onclick="toggleTheme()" id="theme-btn">نمط</button>
        <button class="btn-tool" onclick="toggleLang()" id="lang-btn">English</button>
    </div>
    
    <img src="https://i.ibb.co/fYWfbWBQ/logo.png" alt="Logo" class="main-logo">

    <div class="card">
        <button class="share-mini" onclick="doShare(0)" data-i18n="share">مشاركة</button>
        <div class="event-title" data-i18n="ramadan-title"></div>
        <span style="font-size: 0.8rem; color: var(--text-muted);" data-i18n="ramadan-date"></span>
        <div class="timer-grid">
            <div class="box"><span class="num" id="d1">0</span><span class="label" data-i18n="days"></span></div>
            <div class="box"><span class="num" id="h1">0</span><span class="label" data-i18n="hours"></span></div>
            <div class="box"><span class="num" id="m1">0</span><span class="label" data-i18n="mins"></span></div>
            <div class="box"><span class="num" id="s1">0</span><span class="label" data-i18n="secs"></span></div>
        </div>
        <div class="notify-row">
            <span data-i18n="notify">تفعيل التنبيهات</span>
            <label class="switch"><input type="checkbox" class="notif-check" onchange="handleToggle(this)"><span class="slider"></span></label>
        </div>
    </div>

    <div class="card">
        <button class="share-mini" onclick="doShare(1)" data-i18n="share">مشاركة</button>
        <div class="event-title" data-i18n="eid1-title"></div>
        <span style="font-size: 0.8rem; color: var(--text-muted);" data-i18n="eid1-date"></span>
        <div class="timer-grid">
            <div class="box"><span class="num" id="d2">0</span><span class="label" data-i18n="days"></span></div>
            <div class="box"><span class="num" id="h2">0</span><span class="label" data-i18n="hours"></span></div>
            <div class="box"><span class="num" id="m2">0</span><span class="label" data-i18n="mins"></span></div>
            <div class="box"><span class="num" id="s2">0</span><span class="label" data-i18n="secs"></span></div>
        </div>
        <div class="notify-row">
            <span data-i18n="notify">تفعيل التنبيهات</span>
            <label class="switch"><input type="checkbox" class="notif-check" onchange="handleToggle(this)"><span class="slider"></span></label>
        </div>
    </div>

    <div class="verse-box">
        <span class="quran-text">﴿شَهْرُ رَمَضَانَ الَّذِي أُنزِلَ فِيهِ الْقُرْآنُ هُدًى لِّلنَّاسِ وَبَيِّنَاتٍ مِّنَ الْهُدَىٰ وَالْفُرْقَانِ ۚ فَمَن شَهِدَ مِنكُمُ الشَّهْرَ فَلْيَصُمْهُ ۖ وَمَن كَانَ مَرِيضًا أَوْ عَلَىٰ سَفَرٍ فَعِدَّةٌ مِّنْ أَيَّامٍ أُخَرَ ۗ يُرِيدُ اللَّهُ بِكُمُ الْيُسْرَ وَلَا يُرِيدُ بِكُمُ الْعُسْرَ وَلِتُكْمِلُوا الْعِدَّةَ وَلِتُكَبِّرُوا اللَّهَ عَلَىٰ مَا هَدَاكُمْ وَلَعَلَّكُمْ تَشْكُرُونَ﴾</span>
        <span id="trans-1" class="translation-text"></span>
        <span class="verse-ref" data-i18n="v1-ref"></span>
    </div>

    <div class="card">
        <button class="share-mini" onclick="doShare(2)" data-i18n="share">مشاركة</button>
        <div class="event-title" data-i18n="hajj-title"></div>
        <span style="font-size: 0.8rem; color: var(--text-muted);" data-i18n="hajj-date"></span>
        <div class="timer-grid">
            <div class="box"><span class="num" id="d4">0</span><span class="label" data-i18n="days"></span></div>
            <div class="box"><span class="num" id="h4">0</span><span class="label" data-i18n="hours"></span></div>
            <div class="box"><span class="num" id="m4">0</span><span class="label" data-i18n="mins"></span></div>
            <div class="box"><span class="num" id="s4">0</span><span class="label" data-i18n="secs"></span></div>
        </div>
        <div class="notify-row">
            <span data-i18n="notify">تفعيل التنبيهات</span>
            <label class="switch"><input type="checkbox" class="notif-check" onchange="handleToggle(this)"><span class="slider"></span></label>
        </div>
    </div>

    <div class="card">
        <button class="share-mini" onclick="doShare(3)" data-i18n="share">مشاركة</button>
        <div class="event-title" data-i18n="eid2-title"></div>
        <span style="font-size: 0.8rem; color: var(--text-muted);" data-i18n="eid2-date"></span>
        <div class="timer-grid">
            <div class="box"><span class="num" id="d3">0</span><span class="label" data-i18n="days"></span></div>
            <div class="box"><span class="num" id="h3">0</span><span class="label" data-i18n="hours"></span></div>
            <div class="box"><span class="num" id="m3">0</span><span class="label" data-i18n="mins"></span></div>
            <div class="box"><span class="num" id="s3">0</span><span class="label" data-i18n="secs"></span></div>
        </div>
        <div class="notify-row">
            <span data-i18n="notify">تفعيل التنبيهات</span>
            <label class="switch"><input type="checkbox" class="notif-check" onchange="handleToggle(this)"><span class="slider"></span></label>
        </div>
    </div>

    <div class="verse-box">
        <span class="quran-text">﴿الْحَجُّ أَشْهُرٌ مَّعْلُومَاتٌ ۚ فَمَن فَرَضَ فِيهِنَّ الْحَجَّ فَلَا رَفَثَ وَلَا فُسُوقَ وَلَا جِدَالَ فِي الْحَجِّ ۗ وَمَا تَفْعَلُوا مِنْ خَيْرٍ يَعْلَمْهُ اللَّهُ ۗ وَتَزَوَّدُوا فَإِنَّ خَيْرَ الزَّادِ التَّقْوَىٰ ۚ وَاتَّقُونِ يَا أُولِي الْأَلْبَابِ﴾</span>
        <span id="trans-2" class="translation-text"></span>
        <span class="verse-ref" data-i18n="v2-ref"></span>
    </div>

    <script>
        // ... (نفس بيانات i18n السابقة)
        const i18n = {
            ar: {
                "share": "مشاركة", "days": "يوم", "hours": "ساعة", "mins": "دقيقة", "secs": "ثانية",
                "notify": "تفعيل التنبيهات", "copy-msg": "تم نسخ التفاصيل بنجاح!",
                "ramadan-title": "شهر رمضان المبارك", "ramadan-date": "1 رمضان 1447 هـ | 18 فبراير 2026 م",
                "eid1-title": "عيد الفطر المبارك", "eid1-date": "1 شوال 1447 هـ | 20 مارس 2026 م",
                "hajj-title": "عشر ذي الحجة", "hajj-date": "1 ذو الحجة 1447 هـ | 18 مايو 2026 م",
                "eid2-title": "عيد الأضحى المبارك", "eid2-date": "10 ذو الحجة 1447 هـ | 27 مايو 2026 م",
                "v1-ref": "[سورة البقرة: ١٨٥]", "v2-ref": "[سورة البقرة: ١٩٧]", "trans-1": "", "trans-2": "",
                "ramadan-pray": "بلغنا الله وإياكم شهر الصيام ونحن في أحسن حال.",
                "eid1-pray": "تقبل الله منا ومنكم صالح الأعمال وعساكم من عواده.",
                "hajj-pray": "خير أيام الدنيا.. أعاننا الله وإياكم فيها على ذكره وشكره وحسن عبادته.",
                "eid2-pray": "عيدكم مبارك، وتقبل الله طاعاتكم وأتم عليكم فرحتكم.",
                "lang-btn": "English", "theme-btn": "نمط"
            },
            en: {
                "share": "Share", "days": "Days", "hours": "Hrs", "mins": "Min", "secs": "Sec",
                "notify": "Notifications", "copy-msg": "Details copied successfully!",
                "ramadan-title": "Holy Ramadan", "ramadan-date": "Feb 18, 2026",
                "eid1-title": "Eid Al-Fitr", "eid1-date": "March 20, 2026",
                "hajj-title": "10 Days of Hajj", "hajj-date": "May 18, 2026",
                "eid2-title": "Eid Al-Adha", "eid2-date": "May 27, 2026",
                "v1-ref": "[Surah Al-Baqarah: 185]", "v2-ref": "[Surah Al-Baqarah: 197]",
                "trans-1": "“The month of Ramadhan [is that] in which was revealed the Qur'an...”",
                "trans-2": "“Hajj is [during] well-known months...”",
                "ramadan-pray": "May Allah let us reach Ramadan in the best state.",
                "eid1-pray": "May Allah accept our good deeds. Happy Eid!",
                "hajj-pray": "The best days of the world.. May Allah help us remember Him.",
                "eid2-pray": "Eid Mubarak! May Allah accept your worship.",
                "lang-btn": "عربي", "theme-btn": "Theme"
            }
        };

        let currentLang = localStorage.getItem('lang') || 'ar';

        function updateUI() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.innerText = i18n[currentLang][key];
            });
            document.getElementById('trans-1').innerText = i18n[currentLang]['trans-1'];
            document.getElementById('trans-2').innerText = i18n[currentLang]['trans-2'];
            document.getElementById('lang-btn').innerText = i18n[currentLang]['lang-btn'];
            document.getElementById('theme-btn').innerText = i18n[currentLang]['theme-btn'];
            document.getElementById('main-html').dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            
            // استرجاع حالة التشغيل/الإغلاق من الذاكرة
            const isEnabled = localStorage.getItem('notifs_enabled') === 'true';
            document.querySelectorAll('.notif-check').forEach(btn => {
                btn.checked = isEnabled;
            });
        }

        function handleToggle(el) {
            if(el.checked) {
                Notification.requestPermission().then(p => {
                    if(p === 'granted') {
                        localStorage.setItem('notifs_enabled', 'true');
                        updateAllButtons(true);
                    } else {
                        el.checked = false;
                        alert("يرجى تفعيل الإشعارات من إعدادات المتصفح");
                    }
                });
            } else {
                localStorage.setItem('notifs_enabled', 'false');
                updateAllButtons(false);
            }
        }

        function updateAllButtons(state) {
            document.querySelectorAll('.notif-check').forEach(btn => {
                btn.checked = state;
            });
        }

        function toggleLang() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            localStorage.setItem('lang', currentLang);
            updateUI();
        }

        function toggleTheme() {
            document.body.hasAttribute('data-theme') ? document.body.removeAttribute('data-theme') : document.body.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', document.body.hasAttribute('data-theme') ? 'light' : 'dark');
        }

        function doShare(idx) {
            const ids = ["1", "2", "4", "3"];
            const d = document.getElementById('d' + ids[idx]).innerText;
            const h = document.getElementById('h' + ids[idx]).innerText;
            const m = document.getElementById('m' + ids[idx]).innerText;
            const s = document.getElementById('s' + ids[idx]).innerText;
            // ... (نفس منطق المشاركة السابق)
            alert("تم نسخ النص للمشاركة!");
        }

        function update(id, date) {
            const diff = new Date(date).getTime() - new Date().getTime();
            if (diff > 0) {
                document.getElementById('d'+id).innerText = Math.floor(diff / 86400000);
                document.getElementById('h'+id).innerText = Math.floor((diff % 86400000) / 3600000);
                document.getElementById('m'+id).innerText = Math.floor((diff % 3600000) / 60000);
                document.getElementById('s'+id).innerText = Math.floor((diff % 60000) / 1000);
            }
        }

        setInterval(() => {
            update('1', "2026-02-18T00:00:00"); update('2', "2026-03-20T00:00:00");
            update('3', "2026-05-27T00:00:00"); update('4', "2026-05-18T00:00:00");
        }, 1000);

        window.onload = () => {
            updateUI();
            if(localStorage.getItem('theme') === 'light') document.body.setAttribute('data-theme', 'light');
        };
    </script>
</body>
</html>
